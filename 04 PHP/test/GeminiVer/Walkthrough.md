# 手動測試與驗證說明

您好，所有要求的檔案均已建立於 `GeminiVer` 目錄中。

由於環境限制，我無法為您自動啟動 PHP 伺服器。請依照以下步驟自行啟動並進行測試：

## 步驟一：啟動 PHP 內建網頁伺服器

1.  請確認您的電腦已安裝 PHP (建議版本 8.2 或以上)，並且 `php` 指令可以在您的命令提示字元或終端機中執行。
2.  開啟您的命令提示字元 (cmd) 或 PowerShell。
3.  移動到本次作業的根目錄：
    ```shell
    cd "D:\上課教材\2025AI\04 PHP\test"
    ```
4.  執行以下指令來啟動伺服器，並將網站根目錄指向 `GeminiVer`：
    ```shell
    php -S localhost:8000 -t GeminiVer
    ```
5.  如果看到類似 `Development server started on http://localhost:8000` 的訊息，表示伺服器已成功啟動。請保持此視窗開啟。

## 步驟二：功能測試

請開啟您的網頁瀏覽器（建議使用 Chrome 或 Firefox），然後前往 <http://localhost:8000/edit.php>。

### 測試案例 1：正常資料提交

1.  **使用者ID**：輸入 `testuser123`
2.  **使用者名稱**：輸入 `王大明 David`
3.  **出生年份**：輸入 `1995`
4.  **性別**：選擇 `生理男`
5.  **使用者照片**：選擇一張小於 2MB 的圖片（例如 JPG, PNG 格式）。
6.  **Instagram**：輸入 `https://www.instagram.com/testuser`
7.  **Facebook**：輸入 `https://www.facebook.com/test.user.1`
8.  **自我介紹**：輸入 `這是一個自我介紹，<script>alert("XSS")</script> 包含一些文字與符號。`
9.  點擊「提交資料」。
10. **預期結果**：
    *   頁面應成功轉址到 `profile.php`。
    *   所有您輸入的資料都應正確顯示。
    *   自我介紹中的 `<script>` 標籤應被移除，不會跳出警告視窗。
    *   使用者照片應正常顯示。

### 測試案例 2：輸入驗證測試 (前端)

在 `edit.php` 頁面，嘗試輸入不符規則的資料，並在移開輸入框後檢查提示：

1.  **使用者ID**：輸入 `test-user` (包含特殊符號)。
    *   **預期結果**：輸入框下方應出現 "使用者ID只能是英數字。" 的紅色提示。
2.  **出生年份**：輸入 `1899`。
    *   **預期結果**：輸入框下方應出現 "出生年份必須是 1900 到 2100 之間的數字。" 的提示。
3.  **Instagram**：輸入 `not-a-valid-url`。
    *   **預期結果**：輸入框下方應出現 "請輸入有效的 Instagram 網址或使用者名稱。" 的提示。
4.  **預期結果**：在未修正所有錯誤前，點擊「提交資料」按鈕，瀏覽器應會阻止表單提交。

### 測試案例 3：輸入驗證測試 (後端)

您可以透過暫時移除 `edit.php` 中 `</form>` 標籤前的 `<script>` 區塊來停用前端驗證，以測試後端。

1.  停用前端驗證後，輸入不合法的資料（例如將出生年份設為 `3000`）。
2.  點擊「提交資料」。
3.  **預期結果**：
    *   頁面應重新載入 `edit.php`。
    *   頁面頂端應出現紅色的錯誤訊息列表，明確指出哪個欄位出錯。
    *   您先前輸入的合法資料應被保留在表單中。

### 測試案例 4：XSS 防護測試

1.  在 `profile.php` 頁面，檢視您在 **測試案例 1** 中輸入的自我介紹。
2.  **預期結果**：您應該只會看到文字 `這是一個自我介紹， 包含一些文字與符號。`，`<script>` 標籤已被過濾。
3.  檢視網頁原始碼，確認所有從 Session 印出的資料（如 `user_name`）都已被 `htmlspecialchars` 轉義（例如 `&lt;`、`&gt;`）。

### 測試案例 5：CSRF 防護測試

這個測試較難手動模擬，但您可以檢查 `edit.php` 的網頁原始碼，確認：
1.  表單中有一個 `<input type="hidden" name="csrf_token" value="...">` 的欄位。
2.  每次重新整理 `edit.php` 頁面，這個 `value` 的值都會改變（或在 Session 過期前保持一致）。

## 檔案位置

所有產生的檔案都位於 `D:\上課教材\2025AI\04 PHP\test\GeminiVer\` 目錄下。

若有任何問題，請隨時提出。
