# Docker 安裝

## 在 Windows 安裝（搭配 WSL2）

1. 啟用 WSL 2：

   - 打開你的 PowerShell (記得按右鍵選「以系統管理員身分執行」)。
   - 輸入指令：wsl --install。
   - 重開機後，它通常會自動安裝 Ubuntu (這是最常用的 Linux 版本)。

2. 安裝 Docker Desktop

   - 去 Docker 官網下載 "Docker Desktop for Windows"。
   - 安裝過程中，確保勾選 "Use WSL 2 based engine" (使用 WSL 2 引擎)。
   - 啟用 Docker Desktop ，看到左下角的鯨魚圖示變成綠色，就代表成功了！

## 在 MacoOS 安裝

- 安裝 Intel Docker Desktop
- 安裝 Apple Silicon Docker Desktop

## 在 Ubuntu 安裝 (Kali)

1. 安裝

```bash
sudo rm -f /etc/apt/trusted.gpg.d/kali-archive-keyring.gpg
sudo wget -qO - https://archive.kali.org/archive-key.asc | sudo tee /etc/apt/trusted.gpg.d/kali-archive-keyring.asc
sudo apt update
sudo apt install -y docker.io
sudo systemctl enable docker --now
```

2. 加入 dcoker 權限

```bash
sudo usermod -aG docker $USER
newgrp docker
```

3. 執行 dcoker

```bash
dcoker -v
docker images
docker ps -a
docker search hello
docker run --rm hello-world # (加上—rm為執行後即刪除)
```

4. 執行 docker 安裝 php

```bash
# 04 PHP/test/
docker run -d -p 8080:80 -v .:/var/www/html --name my-running-php php:apache
```

5. 執行 docker 安裝 xsslib

```bash
# xsslib/
docker pull vulfocus/xss-labs:latest
docker run -d -p 8081:80 -v .:/app vulfocus/xss-labs:latest
```

6. 安裝 Docker 與 Docker Compose 插件

```bash
# 1. 刪除舊的錯誤設定檔
sudo rm -f /etc/apt/sources.list.d/docker.list

# 2. 更新系統索引並安裝基礎工具
sudo apt update
sudo apt install -y ca-certificates curl gnupg lsb-release

# 3. 建立金鑰存放目錄
sudo install -m 0755 -d /etc/apt/keyrings

# 4. 下載 Debian 的 GPG 金鑰
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# 5. 寫入 Debian 'bookworm' 軟體源 (Kali 最相容的版本)
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
  bookworm stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# 6. 更新系統索引並安裝 Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 7. 檢查 Docker 版本
docker --version
docker compose version

```

啟動容器 docker compose up -d
停止並移除 docker compose down
查看狀態 docker compose ps
查看日誌 docker compose logs -f
執行 docker exec -it [容器名稱或 ID] /bin/bash
docker exec [容器名稱] /usr/bin/mysqldump -u [使用者] -p[密碼] [資料庫名稱] > backup\_$(date +%Y%m%d).sql
ex: docker exec php_mysq_pma-mysql-1 /usr/bin/mysqldump -u root -p'root_password' my_database > bk_$(date +%Y%m%d).sql
