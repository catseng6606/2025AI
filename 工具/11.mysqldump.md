# MySQL 備份

## 建立備份目錄：

``` bash
mkdir -p ~/mysql_backups
cd ~/mysql_backups
```

## 建立腳本檔案： `nano backup_mysql.sh`

``` bash
#!/bin/bash

# --- 設定變數 ---
CONTAINER_NAME="你的容器名稱"    # 例如: mysql_db
DB_USER="root"
DB_PASS="你的密碼"
DB_NAME="要備份的資料庫名稱"     # 若要備份全部請用 --all-databases
BACKUP_PATH="$HOME/mysql_backups"
DATE=$(date +%Y%m%d_%H%M%S)

# --- 執行備份 ---
# 使用 docker exec 執行容器內的 mysqldump
docker exec $CONTAINER_NAME /usr/bin/mysqldump -u$DB_USER -p$DB_PASS $DB_NAME > $BACKUP_PATH/db_backup_$DATE.sql

# --- 壓縮備份檔 (選用，節省空間) ---
gzip $BACKUP_PATH/db_backup_$DATE.sql

# --- 刪除超過 7 天的舊備份 (選用) ---
find $BACKUP_PATH -type f -name "*.sql.gz" -mtime +7 -delete

echo "備份已完成於: $DATE"
```

## 賦予執行權限：

``` bash 
chmod +x backup_mysql.sh
```

## 使用 MySQL 內建的 .my.cnf 配置檔 (推薦) `nano ~/.my.cnf`

``` ini
[client]
user=root
password=你的密碼
```

## 鎖定權限： `chmod 600 ~/.my.cnf`



``` bash
# 假設容器內已經有設定好 /root/.my.cnf
docker cp ~/.my.cnf $CONTAINER_NAME:/root/.my.cnf
docker exec -u root mysql_db chmod 600 /root/.my.cnf
docker exec $CONTAINER_NAME /usr/bin/mysqldump --defaults-extra-file=/root/.my.cnf $DB_NAME > backup.sql

# 進階 mysql_config_editor
```



